# Next.js Property Management Project

## Features
- List all properties
- Allow users to search properties by location, price, and other criteria
- Allow users to view property details
- Allow users to bookmark properties
- Allow users to contact property owners
- Allow the admins to add, edit, and delete properties
- Allow the admins to manage users
- Allow the admins to manage bookings
- Allow the admins to manage reviews

## Frontend
- Tailwind CSS + shadcn/ui for the UI
  - global styles: `src/app/globals.css`
  - AVOID HARDCODING CSS COLORS use the provided css variables in `src/app/globals.css` instead unless absolutely necessary

## Backend (single source)
- PocketBase is used as the single backend solution and will handle:
  - Database (collections, records)
  - Authentication (users, sessions, tokens)
  - File storage (uploads, served files)

- PocketBase integration points:
  - Browser client: `src/lib/pocketbase/browser-client.ts`
  - Server client: `src/lib/pocketbase/server-client.ts`
  - Middleware guard: `src/middleware.ts`
  - Environment variable: `NEXT_PUBLIC_POCKETBASE_API_URL` must point to your PocketBase API (e.g. http://127.0.0.1:8090)
  - Optional: generate typed models with `pnm run pb-types` into `src/lib/pocketbase/types/pb-types.ts` and zod schemas into `src/lib/pocketbase/types/pb-zod.ts`

## File Structure
- `/src/lib` has utils and configs for third party libraries
- `/src/components` contains reusable components
- `/src/utils` contains utility functions and types that doesn't rely on any specific framework or library

## Preferences & Conventions
- Avoid using `any` except when absolutely necessary
- Components should never exceed 150 lines - break into smaller components if needed
- Main page components should not exceed 70 lines - extract sections into separate components
-  If a component exceeds ~180 lines, break it into smaller components
-  Never use useEffect for data fetching - use server components and async/await instead or tanstack query if the component is a client component
-  Avoid hardcoding colors i the markup and use the css variables defined in `src/app/globals.css` instead instead i==of bg-white, text-black, etc use bg-foreground, text-foreground, etc unless under unique circumstances

## Next.js App Router Guidelines
- Place route-related components in a `_components` folder adjacent to the route
- Use `nuqs` for client-side search params in client components so server components re-fetch based on URL search params
  - Example: Server component lists properties; search box is a client component that updates URL via `nuqs`
- Next.js App Router + RSCs guidance:
  - Prefer server components for data fetching. Wrap server-rendered async components in `<Suspense>`
  - If a client component needs data, prefetch in the server component and pass as props
  - When creating usage examples and documentation put in `/doc/the-feature` and use markdown
  - Forms should use `react-hook-form` for better validation and error handling
    - Use `FormErrorDisplay` to show form errors
    - Use `FormStateDebug` to debug form state in development
    - When working with pocketbase models use the zod schemas generated by `pnm run pb-types` to validate form data and are outputed to `src/lib/pocketbase/types/pb-zod.ts`
- do NOT document features unless if asked to leave sparse comments here and ther but do not create a markdown file unless asked
## Dev Tooling
- Run type checks: `npx tsc --noEmit`
- Only run the linter when explicitly requested: `npm run lint`

## Notes
- Migrating from previous backend libraries: remove or ignore Drizzle / Better Auth / AWS-specific code now that PocketBase covers DB/auth/files
- If you want, I can add a typed `src/lib/pocketbase/client.ts` that exports both `createBrowserClient` and `createServerClient`, and update examples for common operations (listings fetch, bookmarks, auth flows)
